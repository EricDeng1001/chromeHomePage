"use strict";infinity.modules["add-custom"]=new Vue({el:"#add-custom",data:{cusName:"",cusUrl:"",customType:"color",iconImageOriginal:"",iconCropped:"",iconImageBgColor:"transparent",icoColors:["#F44336","#ff9800","#ffeb3b","#4caf50","#00bcd4","#2196f3","#673ab7",""],selectColor:"#F44336",fontColors:["#ffffff","#F44336","#ff9800","#ffeb3b","#4caf50","#00bcd4","#2196f3","#673ab7","transparent"],selectFontColor:"#ffffff",showText:"",fontSize:34,showBgColor:!1,addSuccess:!1,shareChecked:!1,colorNum:0},methods:{show:function(){var o=this;o.addSuccess=!1,o.cusName="",o.cusUrl="",o.customType="color",o.iconImageOriginal="",o.iconCropped="",o.selectColor="#F44336",o.showText="",o.fontSize=34,o.showBgColor=!1,$("#add-custom").css("display","flex"),$(".add-cus-url")[0].focus(),infinity.with("cropper",function(o){})},hide:function(){this.addSuccess=!1,$(".add-custom-cover").hide()},goOnAdd:function(){var o=this;o.addSuccess=!1,o.cusName="",o.cusUrl="",o.customType="color",o.iconImageOriginal="",o.iconCropped="",o.selectColor="#F44336",o.showText="",o.fontSize=34,o.showBgColor=!1},onAddSuccess:function(){this.addSuccess=!0},inputUrl:function(){var o=this;$.debounce(1500,!1,function(){var i=infinity.isUrl(o.cusUrl);i.isValid&&$.get(i.str,function(i){try{e=$(i).filter(function(o,i){return"TITLE"==i.tagName})[0].text}catch(o){var e=""}"Redirect"!=e&&(o.cusName=e,o.showText=o.cusName.substr(0,2).toUpperCase(),o.showBgColor=!0)})})()},inputName:function(){var o=this;""==o.showText&&(o.showText=o.cusName.substr(0,2).toUpperCase(),o.showBgColor=!0),""==o.cusName&&(o.showText="",o.showBgColor=!1)},keyupName:function(){var o=this;""==o.showText&&(o.showText=o.cusName.substr(0,2).toUpperCase(),o.showBgColor=!0),""==o.cusName&&(o.showText="",o.showBgColor=!1)},setIconColor:function(o,i,e){var n=this;i&&(n.showBgColor=!0,n.selectColor=i,n.colorNum=e)},callbackSeticoColor:function(o){this.selectColor=o},sendicoColorMessage:function(o){},initPickColor:function(o,i){var e={callbackFn:this.callbackSeticoColor,callbackBgFn:this.sendicoColorMessage};this.colorNum=i,infinity.modules.main.pickColor(o,e)},clearFileValue:function(o){o.target.value=""},imgload:function(o){var i=this,e=o.srcElement.files[0],n=new FileReader;n.readAsDataURL(e),n.onload=function(o){i.iconImageOriginal=o.target.result,infinity.with("cropper",function(e){e.onEditImage(o.target.result,function(o,e){i.iconCropped=o,i.iconImageBgColor=e},!0)})}},editThisImage:function(o){if("add-cus-selected-image"==o.target.id){var i=this;infinity.with("cropper",function(o){o.onEditImage(i.iconImageOriginal,function(o,e){i.iconCropped=o,i.iconImageBgColor=e},!0)})}},reupload:function(o){this.iconCropped=""},customAdd:function(){var o=this;if(o.cusName)if(o.iconCropped||"image"!=o.customType){var i=null;if("image"==o.customType){var e=o.shareChecked,n=o.iconImageBgColor;i={src:o.iconCropped,imageType:"image",name:o.cusName,url:infinity.isUrl(o.cusUrl).str,uid:infinity.id("800")},infinity.setIconImageBgColorSrc(n,!1,i.src,function(n){i.src=n;try{infinity.modules["add-library"].onAddIcon(!1,i),o.onAddSuccess(),e&&infinity.sendMessage("shareIcon",{name:o.cusName,url:i.url,src:n})}catch(o){void 0}})}else{i={imageType:"color",name:o.cusName,url:infinity.isUrl(o.cusUrl).str,showText:o.showText,bgColor:o.selectColor,fontSize:o.fontSize,uid:infinity.id("800")};try{infinity.modules["add-library"].onAddIcon(!1,i),o.onAddSuccess()}catch(o){void 0}}}else infinity.with("alert",function(o){o.show(infinity.i18n("please_select_image"))});else infinity.with("alert",function(o){o.show(infinity.i18n("please_input_name"))})},isLoginToShare:function(){var o=this;infinity.getUserInfo().isLogin||1==o.shareChecked&&(infinity.with("info",function(o){o.show(infinity.i18n("please_login_before_share"),!0)}),infinity.with("login",function(i){i.show(),o.shareChecked=!1}))}}});